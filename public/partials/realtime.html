<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="dashboard_graph x_panel">
            <div class="row x_title">
                <div class="col-md-6">
                    <h3>Realtime <small>live hardbeats</small></h3>
                </div>
            </div>
            <div class="x_content">
                <div class="container" style="height:250px">
                    <div id="realtime-graph" style="width: 100%; height:250px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="../bower_components/Flot/jquery.flot.js"></script>
<script src="../bower_components/Flot/jquery.flot.time.js"></script>
<script src="../bower_components/Flot/jquery.flot.resize.js"></script>
<script src="../js/jquery.flot.axislabels.js"></script>

<script>
    var data = [];
    var len = 100;

    var options = {
        series: {
            curvedLines: {
                apply: true,
                active: true,
                monotonicFit: true
            }
        },
        xaxis: {
            mode: 'time',
            timeformat: '%S',
            axisLabel: 'Time',
        },
        yaxis: {
            axisLabel: 'BPM',
            min: 40,
            max: 80
        },
        colors: ["#26B99A"],
        grid: {
            borderWidth: {
                top: 0,
                right: 0,
                bottom: 1,
                left: 1
            },
            borderColor: {
                bottom: "#7F8790",
                left: "#7F8790"
            }
        }
    };

    function translateToFlot(item) {
        var time = new Date(item.date).getTime();
        var bpm = item.bpm;
        return [[ time, bpm ]];
    }

    function randomPush() {
        data.shift();

        while (data.length < len) {
            var y = Math.random() * 10 + 50;
            var x = new Date(Date.now()).getTime();
            data.push([x, y]);
        }
    }

    function update() {
        randomPush();

        $.plot($("#realtime-graph"), [{
            label: "Heartbeat",
            data: data,
            lines: {
                fillColor: "rgba(150, 202, 89, 0.12)"
            }, //#96CA59 rgba(150, 202, 89, 0.42)
            points: {
                fillColor: "#fff"
            }
        }], options);
        setTimeout(update, 50);
    }

    $(document).ready(function() {

//        $.get('/api/user/find?id=1', function(res) {
//            if (res.status !== 'success') {
//                console.log(res.error);
//                return;
//            }
//
//            data = $.map(res.data.bpms, translateToFlot);
//            var plot = $.plot($("#realtime-graph"), [{
//                label: "Heartbeat",
//                data: data,
//                lines: {
//                    fillColor: "rgba(150, 202, 89, 0.12)"
//                }, //#96CA59 rgba(150, 202, 89, 0.42)
//                points: {
//                    fillColor: "#fff"
//                }
//            }], options);
//        });

        update();
    });
</script>